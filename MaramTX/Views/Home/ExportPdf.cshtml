
@using TXTextControl.Web
@using TXTextControl.Web.MVC
@using System.Text
@using MaramTX.Controllers




@Html.TXTextControl().TextControl(settings =>
{
    
    settings.Dock = DockStyle.Fill;
}).LoadText("C:/Users/user/source/repos/MaramTX/MaramTX/wwwroot/maramtest.txt",
    StreamType.WordprocessingML).Render()

<button onclick="ExportPDF()" class="btn mt-3 btn-success">Export PDF</button>
<script>
    function ExportPDF() {
        debugger
        var bDocument;
        var serviceURL = "@Url.Action("ExportPDF", "Home")";
        // save document
        TXTextControl.saveDocument(TXTextControl.StreamType.InternalUnicodeFormat, function (e) {
            bDocument = e.data;
            // send document to controller
            $.ajax({
                type: "POST",
                url: serviceURL,
                data: {
                    document: e.data
                },
                success: successFunc,
                error: errorFunc
            });
        });
    }
    function successFunc(data, status) {
        // create temporary link to download document
        var element = document.createElement('a');
        element.setAttribute('href', 'data:application/octet-stream;base64,' + data);
        element.setAttribute('download', "test.pdf");
        element.style.display = 'none';
        document.body.appendChild(element);
        // simulate click
        element.click();
        // remove the link
        document.body.removeChild(element);
    }
    function errorFunc() {
        alert("Error");
    }


</script>